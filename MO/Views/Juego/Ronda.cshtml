@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Pregunta en curso</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f8ff;
            text-align: center;
            padding: 40px;
        }

        h3 {
            font-weight: 600;
            margin-bottom: 25px;
        }

        #timer {
            font-size: 22px;
            color: #ff3b3b;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .opcion {
            background: #ffffff;
            border-radius: 12px;
            padding: 10px;
            margin: 10px auto;
            width: 50%;
            border: 2px solid #cdd8ff;
            text-align: left;
            transition: 0.2s;
        }

        .opcion:hover {
            background-color: #e9f0ff;
        }

        .btn {
            margin-top: 25px;
            font-size: 16px;
        }
    </style>

    <script>
        let tiempoRestante = 30;
        let tiempoInicio = new Date().getTime();

        function actualizarTimer() {
            document.getElementById("timer").innerText = tiempoRestante + " segundos restantes";
            tiempoRestante--;

            if (tiempoRestante < 0) {
                // Si se acaba el tiempo, se envía automáticamente sin seleccionar respuesta
                document.getElementById("tiempoRespuesta").value = 31;
                document.getElementById("formPregunta").submit();
            } else {
                setTimeout(actualizarTimer, 1000);
            }
        }

        // Cuando el jugador presiona "Responder"
        function enviarRespuesta() {
            let tiempoActual = new Date().getTime();
            let tiempoTomado = Math.floor((tiempoActual - tiempoInicio) / 1000);
            document.getElementById("tiempoRespuesta").value = tiempoTomado;
            document.getElementById("formPregunta").submit();
        }

        window.onload = actualizarTimer;
    </script>
</head>

<body>
    <div class="container">
        <h3>@ViewBag.Pregunta.texto_pregunta</h3>

        <div id="timer">30 segundos restantes</div>

        <form id="formPregunta" method="post" action="/Juego/Responder">
            <input type="hidden" name="idPregunta" value="@ViewBag.Pregunta.id_pregunta" />
            <input type="hidden" id="tiempoRespuesta" name="tiempoRespuesta" value="0" />

            @foreach (var r in ViewBag.Respuestas)
            {
                <div class="opcion">
                    <input type="radio" name="idRespuesta" value="@r.id_respuesta" required />
                    <label>@r.texto_respuesta</label>
                </div>
            }

            <button type="button" class="btn btn-primary" onclick="enviarRespuesta()">Responder</button>
        </form>
    </div>
</body>
</html>
